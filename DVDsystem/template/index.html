
<!DOCTYPE HTML>
<html>
<head>
<title>影碟系统</title>


<link href="../css/bootstrap.css" rel="stylesheet" type="text/css" media="all"/>
<link href="../css/style.css" rel="stylesheet" type="text/css" media="all" />
<link href="../css/owl.carousel.css" rel="stylesheet">
<link href="../css/login.css" rel="stylesheet"/>

<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />


<script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>

<script src="../Js/jquery.min.js"></script>
<script type="text/javascript" src="../Js/bootstrap-3.1.1.min.js"></script>
<script src="../Js/classie.js"></script>
<script src="../Js/uisearch.js"></script>
<script src="../Js/owl.carousel.js"></script>

<script>
    $(document).ready(function () {
                    $("#owl-demo").owlCarousel({
                        items: 3,
                        lazyLoad: true,
                        autoPlay: true,
                        pagination: false,
                    });
                });
</script>

    <script type="text/javascript">

        jQuery(document).ready(function ($){
            $('.theme-login').click(function () {
                $('.theme-popover-mask').fadeIn(100);
                $('.theme-popover').slideDown(200);
            })
            $('.theme-poptit .close').click(function () {
                $('.theme-popover-mask').fadeOut(100);
                $('.theme-popover').slideUp(200);
            })
        })

        function getimg() {//我们就是通过这个函数来异步获取信息的
            document.getElementById("checkimg").src = "yzheng.ashx?" + Math.random();
        }

        window.onload = function onLoginLoaded()
        {

            GetLastUser();

        }


        function GetLastUser() {
            var id = "C005-7D5B-4231-8CEA-1693";//GUID标识符  setcookie(name,value,expire,path,domain,secure)
            var usr = GetCookie(id);
            if (usr != null) {
                document.getElementById('txtUserName').value = usr;
            } else {
                document.getElementById('txtUserName').value = "a1234";
            }
            GetPwdAndChk();
        }

        //点击登录时触发客户端事件
        function slideup() {
            jQuery('#button').click();
        }

        function registercheckuser() {
            usernamecheck = new RegExp("^[a-zA-Z][a-zA-Z0-9_]{0,8}$");//字母或者@开头的最多9位账户
            passworldcheck = new RegExp("^[0-9][0-9]{0,8}$");//9位密码
            checkcode = new RegExp("[0-9]{5}$");

            var result = document.getElementById('txtUserName').value.match(usernamecheck);
            var result2 = document.getElementById('txtPassword').value.match(passworldcheck);
            var result3 = document.getElementById('verification').value.match(checkcode);

            if (result != null && result2 != null && result3 != null) {
                register();
            }
            else if (result == null) { alert("请检测用户名格式是否输入有误!!"); return false; }
            else if (result2 == null) { alert("请检查密码格式是否输入有误!!"); return false; }
            else { alert("请检查验证码格式是否输入有误!!"); return false; }

        }
        function register()
        {
            var username=document.getElementById("txtUserName").value;
            var password = document.getElementById("txtPassword").value;
            var checkcode = document.getElementById("verification").value;

            ajax("register.ashx?username=" + username + "&password=" + password + "&checkcode=" + checkcode, function (responsetext)
            {
                if (responsetext == "checkcodeerror")
                {
                    document.getElementById("usererror").innerHTML = "";
                    document.getElementById("checkcodeerror").innerHTML = "验证码输入有误!";
                    document.getElementById("checkcodeerror").style.color = "#1e1e1e";
                }
                else if (responsetext == "ok")
                {
                    document.getElementById("usererror").innerHTML = "";
                    document.getElementById("checkcodeerror").innerHTML = "";

                    var usr = document.getElementById('txtUserName').value;
                    SetLastUser(usr);
                    slideup();
                    window.location.href = "index.ashx?username=" + usr;
                }
                else if (responsetext == "nameerro")
                {
                    document.getElementById("usererror").innerHTML = "用户名重复,请重新输入";
                    document.getElementById("usererror").style.color = "#1e1e1e";
                    document.getElementById("checkcodeerror").innerHTML = "";

                }
            })

        }
        function checkuser() {
            usernamecheck = new RegExp("^@[a-zA-Z0-9_]{0,8}$|^[a-zA-Z][a-zA-Z0-9_]{0,8}$");//字母或者@开头的最多9位账户
            passworldcheck = new RegExp("^[0-9][0-9]{0,8}$");//9位密码
            checkcode = new RegExp("[0-9]{5}$");

            var result = document.getElementById('txtUserName').value.match(usernamecheck);
            var result2 = document.getElementById('txtPassword').value.match(passworldcheck);
            var result3 = document.getElementById('verification').value.match(checkcode);

            if (result != null && result2 != null && result3 != null)
            {
                lastcheck();
            }
            else if (result == null) { alert("请检测用户名格式是否输入有误!!"); return false; }
            else if (result2 == null) { alert("请检查密码格式是否输入有误!!"); return false; }
            else { alert("请检查验证码格式是否输入有误!!"); return false; }

        }


        function lastcheck()
        {
            var username=document.getElementById("txtUserName").value;
            var password = document.getElementById("txtPassword").value;
            var checkcode = document.getElementById("verification").value;

            ajax("login.ashx?username=" + username + "&password=" + password + "&checkcode=" + checkcode, function (responsetext) {
                if (responsetext == "usererror") {
                    document.getElementById("usererror").innerHTML = "该用户不存在或者密码错误！";
                    document.getElementById("usererror").style.color = "#1e1e1e";
                    document.getElementById("checkcodeerror").innerHTML = "";
                }

                else if (responsetext == "checkcodeerror") {
                    document.getElementById("usererror").innerHTML = "";
                    document.getElementById("checkcodeerror").innerHTML = "验证码输入有误!";
                    document.getElementById("checkcodeerror").style.color = "#1e1e1e";
                }

                else if (responsetext == "ok")
                {
                    document.getElementById("usererror").innerHTML = "";
                    document.getElementById("checkcodeerror").innerHTML = "";

                    var usr = document.getElementById('txtUserName').value;
                    SetLastUser(usr);
                    //如果记住密码选项被选中
                    if (document.getElementById('chkRememberPwd').checked == true)
                    {
                        var pwd = document.getElementById('txtPassword').value;
                        var expdate = new Date();
                        expdate.setTime(expdate.getTime() + 14 * (24 * 60 * 60 * 1000));
                        //将用户名和密码写入到Cookie
                        SetCookie(usr, pwd, expdate);
                    }
                    else
                    {
                         ResetCookie();
                    }
                    slideup();
                    window.location.href = "index.ashx?username=" + usr;
                }
            })
        }

        function SetLastUser(usr) {
            var id = "C005-7D5B-4231-8CEA-1693";
            var expdate = new Date();
            //当前时间加上两周的时间
            expdate.setTime(expdate.getTime() + 14 * (24 * 60 * 60 * 1000));
            SetCookie(id, usr, expdate);
        }
        //用户名失去焦点时调用该方法

        function GetPwdAndChk() {
            var usr = document.getElementById('txtUserName').value;
            var pwd = GetCookie(usr);
            if (pwd != null) {
                document.getElementById('chkRememberPwd').checked = true;
                document.getElementById('txtPassword').value = pwd;
            } else {
                document.getElementById('chkRememberPwd').checked = false;
                document.getElementById('txtPassword').value = "";
            }
        }
        //取Cookie的值

        function GetCookie(name) {
            var arg = name + "=";
            var alen = arg.length;
            var clen = document.cookie.length;
            var i = 0;
            while (i < clen) {
                var j = i + alen;
                //alert(j);
                if (document.cookie.substring(i, j) == arg) return getCookieVal(j);
                i = document.cookie.indexOf(" ", i) + 1;
                if (i == 0) break;
            }
            return null;
        }

        function getCookieVal(offset) {
            var endstr = document.cookie.indexOf(";", offset);
            if (endstr == -1) endstr = document.cookie.length;
            return unescape(document.cookie.substring(offset, endstr));
        }
        //写入到Cookie

        function SetCookie(name, value, expires) {
            var argv = SetCookie.arguments;
            //本例中length = 3
            var argc = SetCookie.arguments.length;
            var expires = (argc > 2) ? argv[2] : null;
            var path = (argc > 3) ? argv[3] : null;
            var domain = (argc > 4) ? argv[4] : null;
            var secure = (argc > 5) ? argv[5] : false;
            document.cookie = name + "=" + escape(value) + ((expires == null) ? "" : ("; expires=" + expires.toGMTString())) + ((path == null) ? "" : ("; path=" + path)) + ((domain == null) ? "" : ("; domain=" + domain)) + ((secure == true) ? "; secure" : "");
        } //自定义属性编码


        function ResetCookie() {
            var usr = document.getElementById('txtUserName').value;
            var expdate = new Date();
            SetCookie(usr, null, expdate);
        }


        function prevent(){
                jQuery('.theme-popover-mask').fadeIn(100);
                jQuery('.theme-popover').slideDown(200);
        }

            function logout() {

                ajax("login.ashx?deletesesion=true", function (responsetext){})
                window.location.href = "index.ashx";
                }
    </script>
</head>



<!------------------------------------------------------中间内容------------------------------------------------------>


<body>
    <!--header-->
    <div class="header">
        <div class="header-top">
            <div class="container">
                <div class="top-right">
                    <ul>
                        <li class="text"><a class="theme-login" href="javascript:;" onclick="prevent();">登录</a></li>
                        <li class="text"><a class="theme-login" href="javascript:;" onclick="prevent();">注册</a></li>
                    </ul>
                </div>
                <div class="clearfix"></div>
            </div>
        </div>



        <div class="header-bottom">
            <div class="container">
                <!--/.content-->
                <div class="content white">
                    <nav class="navbar navbar-default" role="navigation">
                        <div class="navbar-header">
                            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                                <span class="sr-only">Toggle navigation</span>
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                                <span class="icon-bar"></span>
                            </button>
                            <h1 class="navbar-brand"><a href="index.html">QL影碟出租屋</a></h1>
                        </div>
                        <!-----------------------------------------------------菜单----------------------------------------------------------->

                        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                            <ul class="nav navbar-nav">
                                <li><a href="../Hander/index.ashx">首页</a></li>
                                <li><a href="../Hander/CDproduct.ashx">影碟介绍</a></li>
                                <li><a href="../Hander/rentstate.ashx">出借情况</a></li>
                                <li><a href="../Hander/Helpcilent.ashx">FAQ 帮助中心</a></li>
                            </ul>
                        </div>
                    </nav>
                </div>
                <!---------------------------------------------------------------------------------------------------------------------------->

                <div class="search-box">
                    <div id="sb-search" class="sb-search">
                        <form>
                            <input class="sb-search-input" placeholder="Enter your search term..." type="search" name="search" id="search">
                            <input class="sb-search-submit" type="submit" value="">
                            <span class="sb-icon-search"> </span>
                        </form>
                    </div>
                </div>

                <script> new UISearch( document.getElementById( 'sb-search' ) ); </script>

                <div class="clearfix"></div>
            </div>
        </div>
    </div>
   <!-----------------------------------------登录遮罩层---------------------------------->
    <div class="theme-popover">
        <div class="theme-poptit">
            <a href="javascript:;" title="close" id="button" class="close">×</a>
            <h3>Login or register</h3>
        </div>
        <form class="theme-signin">
            <div class="theme-popbod dform">
                <ol>
                    <li>
                        <strong>UserName：</strong><input class="ipt " id="txtUserName" placeholder=" name."
                                                         type="text" name="log" value="" size="20" />
                    </li>

                    <li>
                        <strong>PassWord：</strong><input class="ipt" id="txtPassword" placeholder=" password. "
                                                         type="password" name="pwd" value="" size="20" /><div id="usererror"></div>

                    </li>

                    <li>
                        <strong>VeriFication:</strong><input class="ipt" type="text" id="verification"
                                                             placeholder="the verification!" name="ver" value="" size="20" />
                        <img src="../Hander/yzheng.ashx" alt="clickchange" height="25px" onclick="getimg()" id="checkimg" />
                        <div id="checkcodeerror"></div>
                    </li>
                    <li>   <input type="checkbox" id="chkRememberPwd" />RemenBer Me</li>
                    <li>
                        <input class="btn btn-primary" type="button" name="submit" onclick="registercheckuser()" value="Create newAccount" />
                        <input class="btn btn-primary" type="button" name="submit" onclick="checkuser()" value="Login myAccount." />
                    </li>
                </ol>
            </div>
        </form>
    </div>
    <div class="theme-popover-mask"></div>
    <!--------------------------------------------------------------------------------------------------->

    <div class="banner-section">
        <div class="container">
            <div class="banner-grids">
                <div class="col-md-6 banner-grid">
                    <p>StoreAddress:中国北京海淀区XX街XX号大厦.</p>
                    <p>Telphonenum:15232256978</p>
                    <a href="../Hander/index.ashx" class="button"> Get in Store </a>
                </div>
                <div class="col-md-6 banner-grid1">
                    <img src=" ../image/01.jpg" class="img-responsive" alt="" />
                </div>
                <div class="clearfix"></div>
            </div>
        </div>
    </div>

</body>
</html>